# 聚合数据新闻API配置指南

## 问题说明

您发现百度抓取的新闻都是假数据，这是因为当前使用的是模拟数据。为了获取真实的新闻数据，我们已经集成了聚合数据的新闻头条API。

## 解决方案：使用聚合数据新闻API

### 1. 注册聚合数据账号

1. 访问 [聚合数据官网](https://www.juhe.cn)
2. 点击右上角「注册」按钮
3. 填写手机号、验证码等信息完成注册
4. 登录账号

### 2. 申请新闻头条API

1. 登录后进入「数据中心」
2. 搜索「新闻头条」或直接访问：https://www.juhe.cn/docs/api/id/138
3. 点击「立即申请」
4. 填写应用信息（可以填写个人学习使用）
5. 提交申请，通常几分钟内会审核通过

### 3. 获取API密钥

1. 申请通过后，进入「个人中心」→「我的数据」
2. 找到「新闻头条」服务
3. 复制您的API Key

### 4. 配置API密钥

#### 方法一：修改settings.json文件

```json
{
  "keywords": "设计,科技,人工智能,AI",
  "updateTime": "09:00",
  "apiKey": "YOUR_ACTUAL_API_KEY_HERE",
  "apiProvider": "juhe",
  "storageType": "sqlite",
  "maxResults": 20,
  "dbPath": "../public/news.db",
  "jsonPath": "../data/news.json"
}
```

#### 方法二：使用环境变量（推荐）

在项目根目录创建 `.env` 文件：
```
JUHE_API_KEY=your_actual_api_key_here
```

### 5. 测试API

配置完成后，运行新闻抓取脚本：

```bash
cd scripts
python3 news_scraper.py
```

成功的日志应该显示：
```
聚合数据API返回 X 条新闻
```

### 6. 免费额度说明

- 聚合数据新闻头条API提供免费额度
- 通常每天有一定的免费调用次数
- 超出免费额度后需要付费
- 具体额度请查看聚合数据官网

### 7. 备用方案

如果暂时无法申请到API密钥，可以：

1. **使用RSS源**：修改代码直接抓取新闻网站的RSS
2. **使用其他免费API**：如天行数据、阿凡达数据等
3. **临时使用模拟数据**：保持当前配置用于开发测试

### 8. 常见问题

**Q: API调用失败怎么办？**
A: 检查API密钥是否正确，网络是否正常，是否超出调用限制

**Q: 返回的新闻数量少怎么办？**
A: 聚合数据API返回的新闻数量有限，可以调整关键词或使用多个API源

**Q: 如何在服务器上部署？**
A: 将配置好的settings.json文件上传到服务器，确保服务器能访问聚合数据API

## 技术实现说明

我们已经在代码中实现了：

1. **聚合数据API集成**：`_search_juhe()` 方法
2. **错误处理**：API调用失败时的降级处理
3. **数据格式化**：将API返回数据转换为统一格式
4. **关键词过滤**：根据设置的关键词筛选相关新闻

配置正确的API密钥后，您将获得真实的新闻数据而不是模拟数据。